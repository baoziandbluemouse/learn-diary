---
date: 2025-10-13
tags:
  - project
---

# 为什么要包管理？

包，在C++中，在不同的平台上，甚至不同的编译器上，会有*包的兼容性的问题，即有些包只能在linux平台上用，这种无法跨平台的问题*，**包管理器不是解决兼容性问题的，解决兼容性问题是包维护者的事情，但是包管理器可以让你马上知道哪些包能在你这个平台用，并且通过包管理器你能很方便地拿来用**

如果很需要跨平台，那我们可能就要考虑java这样的语言了，java的JVM只有一个，所以可以实现一个全平台兼容

一个包的兼容性要考虑哪些东西？
- 操作系统,*包含指令集架构*
- 编译器


# vcpkg的基本使用

现在比较流行的c++包管理器，在clion上可以图形化操作，很方便

vcpkg的使用流程:
- 下载依赖
- 定位Cmake项目到vcpkg
- 通过find_package使用下载好的依赖


基于这个使用流程，vcpkg*常用的有两种模式*:
- 清单模式
- 经典模式->搜索包->安装包->让CMake能定位到vcpkg->find_package

经典模式的问题在于：*直接使用vcpkg install命令，他只会考虑你是什么操作系统，至于编译器会使用你系统中定义好的环境变量指向的编译器*，如果用的不是这个默认编译器，那就会出现兼容性问题了。并且这种模式也只能在本地使用，当你的项目需要分发时，别人根本不知道你用了什么依赖

现在推荐使用的是*清单模式*，他的流程是:
- 提供一个json文件，描述所有依赖信息
- 让CMake能定位到vcpkg
- 此时Vcpkg的CMake文件会根据这个json文件，*现场编译*这个包
- CMake通过*查找自己的toolchain，进行编译*，那么就可以实现使用不同的toolchain不会出现兼容性问题了
- find_package

这样子，兼容性问题解决了，依赖也能很清楚地知道了


# 莫名其妙的问题

clion在使用vcpkg时，经典模式需要给Cmake配置

```
-DCMAKE_PREFIX_PATH=E:/program/vcpkg/installed/x64-mingw-dynamic
```


而清单模式无法解决问题


